{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/data/dataController.ts","src/data/factions.ts","src/editor/editor.ts","src/init.ts","src/lists/armyList.ts","src/lists/factionList.ts","src/lists/unitList.ts","src/objects/availableUnit.ts","src/objects/model.ts","src/objects/unit.ts","src/settings.ts","src/utils/costController.ts"],"names":["f","exports","module","define","amd","window","global","self","this","listbuilder","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length","1","factions_1","__importDefault","settings_1","Data","success","failure","filesLoaded","data","prototype","loadFactionData","_this","faction","default","supportedFactions","indexOf","json","dataFile","request_1","XMLHttpRequest","onload","onFileLoaded","JSON","parse","response","onerror","onFileFailed","open","send","name","jsonData","Adeptus Custodes","icon","Adeptus Mechanicus","Astra Militarum","Blood Angels","Chaos Daemons","Chaos Space Marines","Craftworlds","Dark Angels","Death Guard","Deathwatch","Drukhari","Grey Knights","Harlequins","Imperial Knights","Necrons","Orks","Space Marines","T'au Empire","Thousand Sons","Tyranids","Ynnari","Editor","editorContainerHTML","document","getElementById","editorHTML","style","width","unit","editUnit","id","listContents","list","armyList","type","renderEdit","addModel","removeModel","editLoadout","argStr","args","split","updateModelWargear","editAllegiance","index","updateAllegiance","closeEdit","updateCosts","renderList","editFields","innerHTML","getUnitNameAndCostHTML","globalMax","unitInfo","modelTypes","maxAmount","globalMin","defaultAmount","totalModels","models","model","getModelTypeHTML","max","getStatsHeadersHTML","getModelStatsHTML","getWeaponsHeadersHTML","getWeaponsHTML","getWeaponLoadoutSelectionHTML","getSeperatorHTML","canAdd","canRemove","getButtonRowHTML","allegianceHTML","getAllegianceHTML","costHTML","totalPoints","totalPower","totalWounds","modelId","HTML","html","getUnProfiledStats","modelInfo","M","WS","BS","S","T","W","A","Ld","Sv","selectedWeapons","slot","Wargear","selectedWeaponConfig","_i","_a","weaponId","push","_b","selectedWeapons_1","weapon","weaponInfo","wargear","undefined","WargearAbility","profiles","Range","Type","AP","D","Abilities","desription","description","profile","profileInfo","valueStr","valueId","loadoutLength","selected","weaponsList","cost","Points","formatWeaponsList","weapons","formattedList","modelType","allegiances","Allegiance","selectedAllegiance","dataController_1","costController_1","factionList_1","unitList_1","armyList_1","editor_1","ListBuilder","costs","factionList","unitList","editor","setup","loadingFailure","init","alert","unit_1","ArmyList","HQ","Troops","Elites","Fast Attack","Heavy Support","Dedicated Transport","Flyer","Fortification","Lord Of War","currentUnits","addUnit","removeUnit","tempArray","addSmiteSpell","addFactionSpells","spells","power","points","wounds","updateCostsExt","listContainer","imageName","getImageName","unitTable","createElement","className","getStatsHTML","getAbilitiesHTML","getPsykerHTML","getKeywordsHTML","appendChild","getUnitControls","spacer","controlList","deleteBtn","editBtn","FactionList","menuBtn","setupFactionList","openNav","marginLeft","paddingLeft","closeNav","toggleNav","isOpen","onclick","createFactionListElement","supported","listItem","factionSelected","availableUnit_1","UnitList","currentFaction","availableList","factionData","units","availableListHTML","containingList","typeList","currentType","spellsList","smite","spellType","this_1","spellItem","AvailableUnit","getPointsValue","getPowerValue","getWoundsValue","getModelsValue","modelPoints","PointsIncludesWargear","Model","model_1","Unit","unitId","setupDefaultModels","modelNumStr","stat","stats","value","Wounds","listOfWeapons","amountsPerWeapon","selectedIndex","weaponIndex","numberOf","abilityHTML","abilityList","abilities","ability","factionAbility","htmlString","getFactionAbility","factionSpecialRules","psykerHTML","Psyker","keywords","keyword","toUpperCase","Keywords","keywordHTML","keywords_1","calculateModels","calculateWounds","calculatePoints","calculatePower","newModel","pop","modelIndex","weaponSlot","num","Costs","pointsElement","powerElement","woundsElement","modelsElement"],"mappings":"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","file":"listbuilder.min.js","sourcesContent":["(function(){function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}return e})()","import Factions from '../data/factions';\r\nimport Settings from '../settings';\r\n\r\ninterface DataCollection {\r\n  [key: string]: any;\r\n}\r\n\r\nexport default class Data {\r\n\r\n  public data: DataCollection;\r\n  private filesLoaded: number;\r\n  private success: Function;\r\n  private failure: Function;\r\n\r\n  constructor(success: Function, failure: Function) {\r\n    this.filesLoaded = 0;\r\n    this.success = success;\r\n    this.failure = failure;\r\n    this.data = {};\r\n  }\r\n\r\n  public loadFactionData() {\r\n    for (let faction in Factions) {\r\n      if (Settings.supportedFactions.indexOf(faction) > -1) {\r\n        let json = Factions[faction].dataFile;\r\n        let request = new XMLHttpRequest();\r\n        request.onload = () => {\r\n          this.onFileLoaded(faction, JSON.parse(request.response));\r\n        };\r\n        request.onerror = () => {\r\n          this.onFileFailed();\r\n        };\r\n        request.open('get', '/Content/40kListBuilder/resources/data/' + json);\r\n        request.send();\r\n      }\r\n    }\r\n  }\r\n\r\n  private onFileLoaded(name: string, jsonData: Object) {\r\n    this.filesLoaded++;\r\n    this.data[name] = jsonData;\r\n    if (this.filesLoaded === Settings.supportedFactions.length) {\r\n      this.success();\r\n    }\r\n  }\r\n\r\n  private onFileFailed() {\r\n    this.failure();\r\n  }\r\n}\r\n","// TODO: should just be a list of names, icons, and file locations\r\n\r\nlet factions: any = {\r\n  \"Adeptus Custodes\": {\r\n    \"dataFile\": \"AdeptusCustodes.json\",\r\n    \"icon\": \"talonsoftheemperor.png\"\r\n  },\r\n  \"Adeptus Mechanicus\": {\r\n    \"dataFile\": \"AdeptusMechanicus.json\",\r\n    \"icon\": \"adeptusmechanicus.png\"\r\n  },\r\n  \"Astra Militarum\": {\r\n    \"dataFile\": \"AstraMilitarum.json\",\r\n    \"icon\": \"astramilitarum.png\"\r\n  },\r\n  \"Blood Angels\": {\r\n    \"dataFile\": \"BloodAngles.json\",\r\n    \"icon\": \"bloodangels.png\"\r\n  },\r\n  \"Chaos Daemons\": {\r\n    \"dataFile\": \"Chaosaemons.json\",\r\n    \"icon\": \"chaosdaemons.png\"\r\n  },\r\n  \"Chaos Space Marines\": {\r\n    \"dataFile\": \"ChaosSpaceMarines.json\",\r\n    \"icon\": \"chaosdaemons.png\"\r\n  },\r\n  \"Craftworlds\": {\r\n    \"dataFile\": \"Craftworlds.json\",\r\n    \"icon\": \"craftworld.png\"\r\n  },\r\n  \"Dark Angels\": {\r\n    \"dataFile\": \"DarkAngles.json\",\r\n    \"icon\": \"darkangels.png\"\r\n  },\r\n  \"Death Guard\": {\r\n    \"dataFile\": \"DeathGuard.json\",\r\n    \"icon\": \"deathwatch.png\"\r\n  },\r\n  \"Deathwatch\": {\r\n    \"dataFile\": \"Deathwatch.json\",\r\n    \"icon\": \"hereticastartes.png\"\r\n  },\r\n  \"Drukhari\": {\r\n    \"dataFile\": \"Drukhari.json\",\r\n    \"icon\": \"drukhari.png\"\r\n  },\r\n  \"Grey Knights\": {\r\n    \"dataFile\": \"GreyKnights.json\",\r\n    \"icon\": \"greyknights.png\"\r\n  },\r\n  \"Harlequins\": {\r\n    \"dataFile\": \"Harlequins.json\",\r\n    \"icon\": \"harlequins.png\"\r\n  },\r\n  \"Imperial Knights\": {\r\n    \"dataFile\": \"ImperialKnights.json\",\r\n    \"icon\": \"imperialknights.png\"\r\n  },\r\n  \"Necrons\": {\r\n    \"dataFile\": \"Necrons.json\",\r\n    \"icon\": \"necrons.png\"\r\n  },\r\n  \"Orks\": {\r\n    \"dataFile\": \"Orks.json\",\r\n    \"icon\": \"orks.png\"\r\n  },\r\n  \"Space Marines\": {\r\n    \"dataFile\": \"SpaceMarines.json\",\r\n    \"icon\": \"spacemarines.png\"\r\n  },\r\n  \"T'au Empire\": {\r\n    \"dataFile\": \"TauEmpire.json\",\r\n    \"icon\": \"tau.png\"\r\n  },\r\n  \"Thousand Sons\": {\r\n    \"dataFile\": \"ThousandSons.json\",\r\n    \"icon\": \"hereticastartes.png\"\r\n  },\r\n  \"Tyranids\": {\r\n    \"dataFile\": \"Tyranids.json\",\r\n    \"icon\": \"tyranids.png\"\r\n  },\r\n  \"Ynnari\": {\r\n    \"dataFile\": \"Ynnari.json\",\r\n    \"icon\": \"ynnari.png\"\r\n  }\r\n};\r\n\r\nexport default factions;\r\n","export default class Editor {\r\n\r\n  private editorContainerHTML: HTMLElement;\r\n  private editorHTML: HTMLElement;\r\n  private unit: any;\r\n  \r\n  public constructor() {\r\n    this.editorContainerHTML = (document.getElementById(\"editor\") as HTMLElement);\r\n    this.editorHTML = (document.getElementById(\"editorForm\") as HTMLElement);\r\n    this.editorContainerHTML.style.width = '0px';\r\n    this.unit = {};\r\n  }\r\n\r\n  public editUnit(id: number) {\r\n    let listContents = window.list.armyList.listContents;\r\n    for (let type in listContents) {\r\n      for (let unit in listContents[type]) {\r\n        if (listContents[type][unit].id === id) {\r\n          this.unit = listContents[type][unit];\r\n          this.renderEdit();\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  public addModel(id) {\r\n    this.unit.addModel(id);\r\n  }\r\n\r\n  public removeModel(id) {\r\n    this.unit.removeModel(id);\r\n  }\r\n\r\n  public editLoadout(argStr) {\r\n    let args = argStr.split('-');\r\n    this.unit.updateModelWargear(args[0], args[1], args[2], args[3]);\r\n  }\r\n\r\n  public editAllegiance(index) {\r\n    this.unit.updateAllegiance(index);\r\n  }\r\n\r\n  public closeEdit() {\r\n    this.editorContainerHTML.style.width = '0px';\r\n    window.list.armyList.updateCosts();\r\n    window.list.armyList.renderList();\r\n  } \r\n\r\n  public renderEdit() {\r\n    this.editorContainerHTML.style.width = '100%';\r\n    let editFields = this.editorHTML.innerHTML;\r\n    editFields = '';\r\n\r\n    editFields += '<table class=\"editTable\">';\r\n    editFields += this.getUnitNameAndCostHTML(this.unit);\r\n\r\n    let globalMax = this.unit.unitInfo.modelTypes[0].maxAmount;\r\n    let globalMin = this.unit.unitInfo.modelTypes[0].defaultAmount;\r\n    let totalModels = 0;\r\n    for (let i = 0; i < this.unit.unitInfo.modelTypes.length; i++) {\r\n      totalModels += this.unit.models[this.unit.unitInfo.modelTypes[i].model].length;\r\n    }\r\n\r\n    for (let i = 0; i < this.unit.unitInfo.modelTypes.length; i++) {\r\n      editFields += this.getModelTypeHTML(this.unit.unitInfo.modelTypes[i].model);\r\n      let models = this.unit.models[this.unit.unitInfo.modelTypes[i].model];\r\n      let max = this.unit.unitInfo.modelTypes[i].maxAmount;\r\n      if (models) {\r\n        for (let model in models) {\r\n          editFields += this.unit.getStatsHeadersHTML();\r\n          editFields += this.getModelStatsHTML(this.unit, models[model]);\r\n          editFields += this.unit.getWeaponsHeadersHTML();\r\n          editFields += this.getWeaponsHTML(models[model], this.unit.faction);\r\n          editFields += this.getWeaponLoadoutSelectionHTML(i, model, models[model]);\r\n          editFields += this.getSeperatorHTML();\r\n        }\r\n        let canAdd = (totalModels < globalMax && models.length < max);\r\n        let canRemove = (totalModels > globalMin && models.length > 0);\r\n        editFields += this.getButtonRowHTML(canAdd, canRemove, i);\r\n        editFields += this.getSeperatorHTML();\r\n      }\r\n    }\r\n\r\n    let allegianceHTML = this.getAllegianceHTML(this.unit);\r\n    if (allegianceHTML !== '') {\r\n      editFields += '<tr><td class=\"modelType\" colspan=\"11\">Allegiance</td></tr>';\r\n      editFields += allegianceHTML;\r\n    }\r\n    editFields += '</table>';\r\n\r\n    editFields += '<button class=\"closeButton\" type=\"button\" onclick=\"list.editor.closeEdit()\">Done</button>';\r\n    this.editorHTML.innerHTML = editFields;\r\n  }\r\n\r\n  private getUnitNameAndCostHTML(unit) {\r\n    let costHTML =  'Points: ' + unit.totalPoints\r\n                 +  ' | Power: ' + unit.totalPower\r\n                 +  ' | Wounds: ' + unit.totalWounds\r\n                 +  ' | Models: ' + unit.totalModels;\r\n    let HTML = '<tr>'\r\n      + '<td class=\"name\" colspan=\"5\">' + unit.name + '</td>'\r\n      + '<td class=\"cost\" colspan=\"6\">' + costHTML + '</td>'\r\n      + '</tr>';\r\n    \r\n    return HTML;\r\n  }\r\n\r\n  private getModelTypeHTML(type) {\r\n    return '<tr><td class=\"modelType\" colspan=\"11\">' + type + '(s)</td></tr>';\r\n  }\r\n\r\n  private getButtonRowHTML(canAdd, canRemove, model) {\r\n    let  modelId = \"'\" + model + \"'\";\r\n    let HTML = '<tr><td colspan=\"11\">';\r\n    if (canAdd) {\r\n      HTML += '<button class=\"add\" type=\"button\" onclick=\"list.editor.addModel(' + modelId + ')\">Add</button>';\r\n    }\r\n    if (canRemove) {\r\n      HTML += '<button class=\"remove\" type=\"button\" onclick=\"list.editor.removeModel(' + modelId + ')\">Remove</button>';\r\n    }\r\n    HTML += '</td></tr>';\r\n    return HTML;\r\n  } \r\n\r\n  private getModelStatsHTML(unit, model) {\r\n    let html = '';\r\n    html += '<tr>'\r\n      + '<td class=\"stat\" id=\"name\">' + model.name + '</td>'\r\n      + '<td class=\"stat\" id=\"m\">' + unit.getUnProfiledStats(model.modelInfo.M) + '</td>'\r\n      + '<td class=\"stat\" id=\"ws\">' + unit.getUnProfiledStats(model.modelInfo.WS) + '</td>'\r\n      + '<td class=\"stat\" id=\"bs\">' + unit.getUnProfiledStats(model.modelInfo.BS) + '</td>'\r\n      + '<td class=\"stat\" id=\"s\">' + unit.getUnProfiledStats(model.modelInfo.S) + '</td>'\r\n      + '<td class=\"stat\" id=\"t\">' + unit.getUnProfiledStats(model.modelInfo.T) + '</td>'\r\n      + '<td class=\"stat\" id=\"w\">' + unit.getUnProfiledStats(model.modelInfo.W) + '</td>'\r\n      + '<td class=\"stat\" id=\"a\">' + unit.getUnProfiledStats(model.modelInfo.A) +'</td>'\r\n      + '<td class=\"stat\" id=\"ld\">' + unit.getUnProfiledStats(model.modelInfo.Ld) + '</td>'\r\n      + '<td class=\"stat\" id=\"sv\">' + unit.getUnProfiledStats(model.modelInfo.Sv) + '</td>'\r\n      + '<td></td>'\r\n      + '</tr>';\r\n    return html;\r\n  }\r\n\r\n  private getWeaponsHTML(model, faction) {\r\n    let HTML = '';\r\n    let selectedWeapons: Array<string> = [];\r\n    for (let slot in model.modelInfo.Wargear) {\r\n      let index = model.selectedWeaponConfig[slot] || 0;\r\n      for (let weaponId of model.modelInfo.Wargear[slot][index]) {\r\n        selectedWeapons.push(weaponId);\r\n      }\r\n    }\r\n    // let selectedWeapons = model.modelInfo.Wargear.weapons[model.selectedWeaponConfig];\r\n    for (let weapon of selectedWeapons) {\r\n      let weaponInfo = window.list.data.data[faction].wargear[weapon];\r\n      if (weaponInfo !== undefined) {\r\n        if (weaponInfo.WargearAbility !== undefined) {\r\n          HTML += '<tr>'\r\n          + '<td class=\"stat\" id=\"name\">' + weapon + '</td>'\r\n          + '<td class=\"stat\" id=\"abilities\" colspan=\"9\">' + weaponInfo.WargearAbility + '</td>'\r\n          + '</tr>';\r\n        }\r\n        else if (weaponInfo.profiles === undefined) {\r\n          HTML += '<tr>'\r\n          + '<td class=\"stat\" id=\"name\">' + weapon + '</td>'\r\n          + '<td class=\"stat\" id=\"range\">' + weaponInfo.Range + '</td>'\r\n          + '<td class=\"stat\" id=\"type\">' + weaponInfo.Type + '</td>'\r\n          + '<td class=\"stat\" id=\"s\">' + weaponInfo.S + '</td>'\r\n          + '<td class=\"stat\" id=\"ap\">' + weaponInfo.AP + '</td>'\r\n          + '<td class=\"stat\" id=\"d\">' + weaponInfo.D + '</td>'\r\n          + '<td class=\"stat\" id=\"abilities\" colspan=\"4\">' + weaponInfo.Abilities + '</td>'\r\n          + '</tr>';\r\n        }\r\n        else {\r\n          let desription = weaponInfo.description === undefined ? '' : weaponInfo.description;\r\n          HTML += '<tr class=\"profiledWeapon\">'\r\n          + '<td class=\"stat\" id=\"name\">' + weapon + '</td>'\r\n          + '<td class=\"stat\" id=\"description\" colspan=\"9\">' + desription + '</td>'\r\n          + '</tr>';\r\n          for (let profile in weaponInfo.profiles) {\r\n            let profileInfo = weaponInfo.profiles[profile];\r\n            if (profileInfo !== undefined) {\r\n              HTML += '<tr class=\"profile\">'\r\n              + '<td class=\"stat\" id=\"name\"> - ' + profile + '</td>'\r\n              + '<td class=\"stat\" id=\"range\">' + profileInfo.Range + '</td>'\r\n              + '<td class=\"stat\" id=\"type\">' + profileInfo.Type + '</td>'\r\n              + '<td class=\"stat\" id=\"s\">' + profileInfo.S + '</td>'\r\n              + '<td class=\"stat\" id=\"ap\">' + profileInfo.AP + '</td>'\r\n              + '<td class=\"stat\" id=\"d\">' + profileInfo.D + '</td>'\r\n              + '<td class=\"stat\" id=\"abilities\" colspan=\"4\">' + profileInfo.Abilities + '</td>'\r\n              + '</tr>';\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return HTML;\r\n  }\r\n\r\n  private getWeaponLoadoutSelectionHTML(type, id, model) {\r\n    let valueStr = '' + type + '-' + id + '-';\r\n    let HTML = '<tr><td colspan=\"11\">';\r\n    for (let slot in model.modelInfo.Wargear) {    \r\n      let valueId = valueStr + slot + '-';\r\n      let loadoutLength = model.modelInfo.Wargear[slot].length;\r\n      if (loadoutLength > 1) {\r\n        let selected = model.selectedWeaponConfig[slot] || 0;\r\n        HTML += '<select onchange=\"window.list.editor.editLoadout(value);\">';   \r\n        for (let i = 0; i < loadoutLength; i++) {\r\n          let weaponsList = model.modelInfo.Wargear[slot][i];\r\n          let cost = 0;\r\n          for (let weapon = 0; weapon < weaponsList.length; weapon++) {\r\n            cost += window.list.data.data[this.unit.faction].wargear[weaponsList[weapon]].Points;\r\n          }\r\n          if (i == selected) {\r\n            HTML += '<option value=\"' + valueId + i + '\" selected=\"selected\">' + this.formatWeaponsList(model.modelInfo.Wargear[slot][i], cost) + '</option>';\r\n          }\r\n          else {     \r\n            HTML += '<option value=\"' + valueId + i + '\">' + this.formatWeaponsList(model.modelInfo.Wargear[slot][i], cost) + '</option>';\r\n          }\r\n        }\r\n        HTML += '</select>';\r\n      }\r\n      else {\r\n        let cost = 0;\r\n        let weaponsList = model.modelInfo.Wargear[slot][0];\r\n        for (let weapon = 0; weapon < weaponsList.length; weapon++) {\r\n          cost += window.list.data.data[this.unit.faction].wargear[weaponsList[weapon]].Points;\r\n        }\r\n        let name = this.formatWeaponsList(model.modelInfo.Wargear[slot][0], cost);\r\n        HTML += '<div class=\"selectSingle\">' + name + '</div>';\r\n      }\r\n    }\r\n    HTML += '</td></tr>';\r\n    return HTML;\r\n  }\r\n\r\n  private formatWeaponsList(weapons, cost) {\r\n    let formattedList = '';\r\n    for (let i = 0; i < weapons.length; i++) {\r\n      formattedList += weapons[i];\r\n      if (i !== weapons.length - 1) {\r\n        formattedList += ' | ';\r\n      }\r\n    }\r\n    if (formattedList !== \"\") {\r\n      formattedList += ' (' + cost + ' pnts)';\r\n    }\r\n    else {\r\n      formattedList = '&lt;empty&gt;';\r\n    }\r\n    return formattedList;\r\n  }\r\n\r\n  private getAllegianceHTML(unit) {\r\n    let HTML = '';\r\n    for (let modelType in unit.models) {\r\n      if (unit.models[modelType].length > 0) {\r\n        let allegiances = unit.models[modelType][0].modelInfo.Allegiance;\r\n        if (allegiances !== undefined) {\r\n          let selected = unit.models[modelType][0].selectedAllegiance;\r\n          HTML += '<tr><td colspan=\"11\"><select onchange=\"window.list.editor.editAllegiance(value);\">';\r\n          for (let i = 0; i < allegiances.length; i++) {\r\n            if (i == selected) {\r\n              HTML += '<option selected=\"selected\" value=\"' + i + '\">' + allegiances[i] + '</option>';\r\n            }\r\n            else {\r\n              HTML += '<option value=\"' + i + '\">' + allegiances[i] + '</option>';\r\n            }\r\n          }\r\n          HTML += '</select></td></tr>';\r\n          return HTML;\r\n        }\r\n      }\r\n    }\r\n    return HTML;\r\n  }\r\n\r\n  private getSeperatorHTML() {\r\n    return '<tr><td class=\"seperator\" colspan=\"11\"><hr/></td></tr>';\r\n  }\r\n}\r\n","import Data from '../src/data/dataController';\r\nimport Costs from '../src/utils/costController';\r\nimport FactionList from '../src/lists/factionList';\r\nimport UnitList from '../src/lists/unitList';\r\nimport ArmyList from '../src/lists/armyList';\r\nimport Editor from '../src/editor/editor';\r\n\r\nexport default class ListBuilder {\r\n\r\n  public data: Data;\r\n  public costs: Costs;\r\n  public factionList: FactionList;\r\n  public unitList: UnitList;\r\n  public armyList: ArmyList;\r\n  public editor: Editor;\r\n\r\n  constructor() {\r\n    this.costs = new Costs();\r\n    this.factionList = new FactionList();\r\n    this.unitList = new UnitList();\r\n    this.armyList = new ArmyList();\r\n    this.editor = new Editor();\r\n    this.data = new Data(this.setup, this.loadingFailure);\r\n  }\r\n\r\n  public loadFactionData() {\r\n    this.data.loadFactionData();\r\n  }\r\n\r\n  public setup() {\r\n    window.list.costs.init();\r\n    window.list.factionList.init();\r\n  }\r\n\r\n  public loadingFailure() {\r\n    alert('Faction data failed to load :(');\r\n  }\r\n}\r\n\r\nlet list = new ListBuilder();\r\nlist.loadFactionData();\r\n\r\ndeclare global {\r\n  interface Window {\r\n    list: ListBuilder;\r\n  }\r\n}\r\nwindow.list = list;\r\n\r\n/**\r\n * X 1. Load all the supported faction files\r\n * X 2. Create the cost header \r\n * X 3. Create the faction list\r\n * X 4. Create the army list\r\n * X 5.   Create the available unit list\r\n * X 6.   Populate the army list\r\n * 7.   Create the editor\r\n * \r\n * TODOs: \r\n *  - Spells\r\n *  - Strategems\r\n *  - Detachments\r\n *  - Warlord traits\r\n *  - A way to tell which weapon goes with which model in print view\r\n */\r\n","import Unit from '../objects/unit';\r\n\r\nexport default class ArmyList {\r\n\r\n  public listContents: any;\r\n  private currentUnits: number;\r\n\r\n  constructor() {\r\n    this.listContents = {\r\n      \"HQ\": [],\r\n      \"Troops\": [],\r\n      \"Elites\": [],\r\n      \"Fast Attack\": [],\r\n      \"Heavy Support\": [],\r\n      \"Dedicated Transport\": [],\r\n      \"Flyer\": [],\r\n      \"Fortification\": [],\r\n      \"Lord Of War\": []\r\n    };\r\n    this.currentUnits = 0;\r\n  }\r\n\r\n  public addUnit(faction: string, type: string, name: string) {\r\n    this.listContents[type].push(new Unit(this.currentUnits, faction, type, name));\r\n    this.currentUnits++;\r\n    this.updateCosts();\r\n    this.renderList();\r\n  }\r\n\r\n  public removeUnit(id: number) {\r\n    for (let type in this.listContents) {\r\n      let tempArray: Array<any> = [];\r\n      for (let unit in this.listContents[type]) {\r\n        if (this.listContents[type][unit].id !== id) {\r\n          tempArray.push(this.listContents[type][unit]);\r\n        }\r\n      }\r\n      this.listContents[type] = tempArray;\r\n    }\r\n    this.updateCosts();\r\n    this.renderList();\r\n  }\r\n\r\n  public addSmiteSpell() {\r\n    // TODO\r\n  }\r\n\r\n  public addFactionSpells(faction: string, spells: string) {\r\n    // TODO\r\n  }\r\n\r\n  public updateCosts() {\r\n    let power = 0;\r\n    let points= 0;\r\n    let wounds = 0;\r\n    let models = 0;\r\n    for (let type in this.listContents) {\r\n      for (let unit of this.listContents[type]) {\r\n        if (unit !== null) {\r\n          power += unit.totalPower;\r\n          points += unit.totalPoints;\r\n          wounds += unit.totalWounds;\r\n          models += unit.totalModels;\r\n        }\r\n      }\r\n    } \r\n    window.list.costs.updateCostsExt([points, power, wounds, models]);\r\n  }\r\n\r\n  public renderList() {\r\n    let listContainer = (document.getElementById(\"newListContents\") as HTMLElement);\r\n    listContainer.innerHTML = '';\r\n    for (let type in this.listContents) {\r\n      if (this.listContents[type].length > 0) {\r\n        let imageName = this.getImageName(type);\r\n        listContainer.innerHTML += '<div id=\"typeHeader\"><img src=\"/Content/40kListBuilder/resources/icons/' + imageName + '\"/><h1>' + type + '</h1></div>';\r\n      }\r\n      for (let unit = 0; unit < this.listContents[type].length; unit++) {\r\n        if (this.listContents[type][unit] !== null) {\r\n          let unitInfo = this.listContents[type][unit] as Unit;\r\n          let unitTable = document.createElement('table');\r\n          unitTable.className = \"unitTable\";\r\n          unitTable.id = '' + unitInfo.id;\r\n          unitTable.innerHTML += unitInfo.getUnitNameAndCostHTML();\r\n          unitTable.innerHTML += unitInfo.getStatsHeadersHTML();\r\n          unitTable.innerHTML += unitInfo.getStatsHTML();\r\n          unitTable.innerHTML += unitInfo.getWeaponsHeadersHTML();\r\n          unitTable.innerHTML += unitInfo.getWeaponsHTML();\r\n          unitTable.innerHTML += unitInfo.getAbilitiesHTML();\r\n          unitTable.innerHTML += unitInfo.getPsykerHTML();\r\n          unitTable.innerHTML += unitInfo.getAllegianceHTML();\r\n          unitTable.innerHTML += unitInfo.getKeywordsHTML();\r\n          listContainer.appendChild(unitTable);\r\n          listContainer.appendChild(this.getUnitControls(unitInfo.id));\r\n          listContainer.innerHTML += '<div class=\"clear\"</div>';\r\n        }\r\n      }\r\n    }\r\n    let spacer = document.createElement('div');\r\n    spacer.className = \"spacer\";\r\n    listContainer.appendChild(spacer);\r\n  }\r\n\r\n  public getImageName(type: string): string {\r\n    let imageName = '';\r\n    switch (type) {\r\n      case \"HQ\":\r\n        imageName = 'hq.png';\r\n        break;\r\n      case \"Troops\":\r\n        imageName = 'troops.png';\r\n        break;\r\n      case \"Elites\":\r\n        imageName = 'elites.png';\r\n        break;\r\n      case \"Fast Attack\":\r\n        imageName = 'fastattack.png';\r\n        break;\r\n      case \"Heavy Support\":\r\n        imageName = 'heavysupport.png';\r\n        break;\r\n      case \"Dedicated Transport\":\r\n        imageName = 'dedicatedtransport.png';\r\n        break;\r\n      case \"Flyer\":\r\n        imageName = 'flyers.png';\r\n        break;\r\n      case \"Fortification\":\r\n        imageName = 'fortifications.png';\r\n        break;\r\n      case \"Lord Of War\":\r\n        imageName = 'lordofwar.png';\r\n        break;\r\n    }\r\n    return imageName;\r\n  }\r\n\r\n  private getUnitControls(id: number): HTMLElement {\r\n    let controlList = document.createElement('ul');\r\n    controlList.className = \"unitControls\";\r\n\r\n    let deleteBtn = document.createElement('li');\r\n    deleteBtn.className = \"button\";\r\n    deleteBtn.id = 'delete' + id;\r\n    deleteBtn.innerHTML = '<img onclick=\"list.armyList.removeUnit(' + id + ')\" src=\"/Content/40kListBuilder/resources/icons/delete.png\"/>';\r\n    controlList.appendChild(deleteBtn);\r\n\r\n    let editBtn = document.createElement('li');\r\n    editBtn.className = \"button\";\r\n    editBtn.id = 'edit' + id;\r\n    editBtn.innerHTML = '<img onclick=\"list.editor.editUnit(' + id + ')\" src=\"/Content/40kListBuilder/resources/icons/edit.png\"/>';\r\n    controlList.appendChild(editBtn);\r\n\r\n    return controlList;\r\n  }\r\n}\r\n","import Factions from '../data/factions';\r\nimport Settings from '../settings';\r\n\r\nexport default class FactionList {\r\n\r\n  private open: boolean;\r\n  private menuBtn: HTMLElement;\r\n  private factionList: HTMLElement;\r\n\r\n  constructor() {\r\n    this.open = false;\r\n    this.menuBtn = (document.getElementById(\"factionBtn\") as HTMLElement);\r\n    this.factionList = (document.getElementById(\"factionList\") as HTMLElement);\r\n  }\r\n\r\n  public init() {\r\n    this.setupFactionList();\r\n  }\r\n\r\n  private openNav() {\r\n    (document.getElementById(\"sidenav\") as HTMLElement).style.width = \"350px\";\r\n    (document.getElementById(\"availableList\") as HTMLElement).style.marginLeft = \"350px\";\r\n    (document.getElementById(\"newList\") as HTMLElement).style.paddingLeft = \"700px\";\r\n    this.open = true;\r\n  }\r\n\r\n  private closeNav() {\r\n    (document.getElementById(\"sidenav\") as HTMLElement).style.width = \"60px\";\r\n    (document.getElementById(\"availableList\") as HTMLElement).style.marginLeft = \"60px\";\r\n    (document.getElementById(\"newList\") as HTMLElement).style.paddingLeft = \"410px\";\r\n    this.open = false;\r\n  }\r\n\r\n  private toggleNav() {\r\n    if (this.open) {\r\n      this.closeNav();\r\n    }\r\n    else {\r\n      this.openNav();\r\n    }\r\n  }\r\n\r\n  private isOpen() {\r\n    return this.open;\r\n  }\r\n\r\n  private setupFactionList() {\r\n    this.menuBtn.onclick = () => { this.toggleNav(); };\r\n    if (!this.isOpen()) {\r\n      this.openNav();\r\n    }\r\n    for (let faction in Factions) {\r\n      if (Settings.supportedFactions.indexOf(faction) !== -1) {\r\n        this.factionList.appendChild(this.createFactionListElement(faction, true));\r\n      }\r\n    }\r\n    for (let faction in Factions) {\r\n      if (Settings.supportedFactions.indexOf(faction) === -1) {\r\n        this.factionList.appendChild(this.createFactionListElement(faction, false));\r\n      }\r\n    }\r\n  }\r\n\r\n  private createFactionListElement(faction: string, supported: boolean): HTMLElement {\r\n    let listItem = document.createElement('li');\r\n    listItem.id = faction;\r\n    if (!supported) {\r\n      listItem.className = \"factionNotSupported\";\r\n    }\r\n    listItem.onclick = () => { this.factionSelected(faction); };\r\n    listItem.innerHTML = '<img src=\"/Content/40kListBuilder/resources/icons/' + Factions[faction].icon + '\"/>' + faction;\r\n    return listItem;\r\n  }\r\n\r\n  private factionSelected(faction: string) {\r\n    window.list.unitList.factionSelected(faction);\r\n    if (this.isOpen()) {\r\n      this.closeNav();\r\n    }\r\n  }\r\n}\r\n","import AvailableUnit from \"../objects/availableUnit\";\r\n\r\nexport default class UnitList {\r\n\r\n  private currentFaction: string;\r\n  private availableList: Array<AvailableUnit>;\r\n\r\n  constructor() {\r\n    this.currentFaction = '';\r\n    this.availableList = [];\r\n  }\r\n\r\n  public factionSelected(faction: string) {\r\n    this.availableList = [];\r\n    this.currentFaction = faction;\r\n    let factionData = window.list.data.data[faction];\r\n    for (let type in factionData.units) {\r\n      let units = factionData.units[type];\r\n      for (let unit in units) {\r\n        this.availableList.push(new AvailableUnit(faction, type, unit));\r\n      }\r\n    }\r\n    this.renderList();\r\n  }\r\n\r\n  private renderList() {\r\n    let availableListHTML = (document.getElementById(\"availableList\") as HTMLElement);\r\n    availableListHTML.innerHTML = '<h2>' + this.currentFaction + '</h2>';\r\n\r\n    let containingList = document.createElement('ul');\r\n    let typeList = document.createElement('ul');\r\n    let currentType = \"\";\r\n    let listItem = document.createElement('li');\r\n\r\n    for (let unit of this.availableList) {\r\n      if (unit.type !== currentType) {\r\n        if (currentType !== \"\") {\r\n          containingList.appendChild(typeList);\r\n          typeList = document.createElement('ul');\r\n        }\r\n        typeList.innerHTML = unit.type + '<hr/>';\r\n        currentType = unit.type;\r\n      }    \r\n      listItem = document.createElement('li');\r\n      listItem.onclick = () => {\r\n        window.list.armyList.addUnit(unit.faction, unit.type, unit.name);\r\n      };\r\n      listItem.innerHTML = unit.name\r\n        + '<br/><div id=\"unitDetails\"><table><tr><td>Points: ' \r\n        + unit.points\r\n        + '</td><td>Power: '\r\n        + unit.power\r\n        + '</td><td>Wounds: '\r\n        + unit.wounds\r\n        + '</td><td>Models: '\r\n        + unit.models\r\n        + '</td></tr></table></div>';\r\n      typeList.appendChild(listItem);\r\n    }\r\n    containingList.appendChild(typeList);\r\n    \r\n    if (window.list.data.data[this.currentFaction].spells !== undefined) {\r\n      let spellsList = document.createElement('ul');\r\n      spellsList.innerHTML = 'Spells<hr/>';\r\n\r\n      let smite = document.createElement('li');\r\n      smite.id = \"smite\";\r\n      smite.onclick = () => {\r\n        window.list.armyList.addSmiteSpell();\r\n      };\r\n      smite.innerHTML = \"Smite\";\r\n      spellsList.appendChild(smite);\r\n\r\n      for (let spellType in window.list.data.data[this.currentFaction].spells) {\r\n        let id = this.currentFaction + '-' + spellType;\r\n        let spellItem = document.createElement('li');\r\n        spellItem.id = id;\r\n        spellItem.onclick = () => {\r\n          window.list.armyList.addFactionSpells(this.currentFaction, spellType);\r\n        };\r\n        spellItem.innerHTML = spellType;\r\n        spellsList.appendChild(spellItem);\r\n      }\r\n      containingList.appendChild(spellsList);\r\n    }\r\n\r\n    availableListHTML.appendChild(containingList);\r\n\r\n    let spacer = document.createElement('div');\r\n    spacer.className = \"spacer\";\r\n    availableListHTML.appendChild(spacer);\r\n  }\r\n}\r\n","export default class AvailableUnit {\r\n\r\n  public faction: string;\r\n  public type: string;\r\n  public name: string;\r\n  public unitInfo: any;\r\n  public points: number;\r\n  public power: number;\r\n  public wounds: number;\r\n  public models: number;\r\n\r\n  constructor(faction: string, type: string, unit: string) {\r\n    this.faction = faction;\r\n    this.type = type;\r\n    this.name = unit;\r\n    this.unitInfo = window.list.data.data[faction].units[type][unit];\r\n    this.points = this.getPointsValue();\r\n    this.power = this.getPowerValue();\r\n    this.wounds = this.getWoundsValue();\r\n    this.models = this.getModelsValue();\r\n  }\r\n\r\n  public getPointsValue() {\r\n    let points = 0;\r\n    for (let modelType of this.unitInfo.modelTypes) {\r\n      let modelPoints = 0;\r\n      let model = window.list.data.data[this.faction].models[modelType.model];\r\n      modelPoints += model.Points;  \r\n      if (!model.PointsIncludesWargear) {\r\n        for (let slot in model.Wargear) {\r\n          for (let weapon = 0; weapon < model.Wargear[slot][0].length; weapon++) {\r\n            modelPoints += window.list.data.data[this.faction].wargear[model.Wargear[slot][0][weapon]].Points;\r\n          } \r\n        }\r\n      }\r\n      points += (modelPoints * modelType.defaultAmount);\r\n    }\r\n    return points;\r\n  }\r\n\r\n  public getPowerValue() {\r\n    let power = 0;\r\n    power += this.unitInfo.power[0][1];\r\n    return power;\r\n  }\r\n\r\n  public getWoundsValue() {\r\n    let wounds = 0;\r\n    for (let modelType of this.unitInfo.modelTypes) {\r\n      let model = window.list.data.data[this.faction].models[modelType.model];\r\n      wounds += (model.W * modelType.defaultAmount); \r\n    }\r\n    return wounds;\r\n  }\r\n\r\n  public getModelsValue() {\r\n    let models = 0;\r\n    for (let modelType of this.unitInfo.modelTypes) {\r\n      models += modelType.defaultAmount;\r\n    }\r\n    return models;\r\n  }\r\n}\r\n","export default class Model {\r\n\r\n  public name: string;\r\n  public modelInfo: any;\r\n  public points: number;\r\n  public selectedWeaponConfig: any; // TODO - multiple slots\r\n  public selectedAllegiance: number;\r\n\r\n  constructor(name: string, modelInfo: any) {\r\n    this.name = name;\r\n    this.modelInfo = modelInfo;\r\n    this.points = modelInfo.Points;\r\n    this.selectedWeaponConfig = {};\r\n    this.selectedAllegiance = 0;\r\n  }\r\n}\r\n","import Model from '../objects/model';\r\n\r\nexport default class Unit {\r\n\r\n  public id: number;\r\n  public faction: string;\r\n  public type: string;\r\n  public name: string;\r\n\r\n  public totalModels: number;\r\n  public totalPoints: number;\r\n  public totalPower: number;\r\n  public totalWounds: number;\r\n\r\n  public unitInfo: any;\r\n  public models: any;\r\n\r\n  constructor(unitId: number, faction: string, type: string, name: string) {\r\n    this.id = unitId;\r\n    this.faction = faction;\r\n    this.type = type;\r\n    this.name = name;\r\n\r\n    this.totalModels = 0;\r\n    this.totalPoints = 0;\r\n    this.totalPower = 0;\r\n    this.totalWounds = 0;\r\n\r\n    this.unitInfo = window.list.data.data[faction].units[type][name];\r\n    this.models = {};\r\n\r\n    this.setupDefaultModels();\r\n    this.updateCosts();\r\n  }\r\n\r\n  public getUnitNameAndCostHTML(): string {\r\n    let costHTML =  'Points: ' + this.totalPoints\r\n                 +  ' | Power: ' + this.totalPower\r\n                 +  ' | Wounds: ' + this.totalWounds\r\n                 +  ' | Models: ' + this.totalModels;\r\n    let HTML = '<tr>'\r\n      + '<td class=\"name\" colspan=\"5\">' + this.name + '</td>'\r\n      + '<td class=\"cost\" colspan=\"5\">' + costHTML + '</td>'\r\n      + '</tr>';\r\n    \r\n    return HTML;\r\n  }\r\n\r\n  public getStatsHeadersHTML(): string {\r\n    let HTML = '<tr>'\r\n        + '<th class=\"statHeader\" id=\"name_H\">Name</th>'\r\n        + '<th class=\"statHeader\" id=\"m_H\">M</th>'\r\n        + '<th class=\"statHeader\" id=\"ws_H\">WS</th>'\r\n        + '<th class=\"statHeader\" id=\"bs_H\">BS</th>'\r\n        + '<th class=\"statHeader\" id=\"s_H\">S</th>'\r\n        + '<th class=\"statHeader\" id=\"t_H\">T</th>'\r\n        + '<th class=\"statHeader\" id=\"w_H\">W</th>'\r\n        + '<th class=\"statHeader\" id=\"a_H\">A</th>'\r\n        + '<th class=\"statHeader\" id=\"ld_H\">Ld</th>'\r\n        + '<th class=\"statHeader\" id=\"sv_H\">Sv</th>'\r\n        + '</tr>';\r\n    return HTML;\r\n  }\r\n\r\n  public getStatsHTML(): string {\r\n    let HTML = '';\r\n    for (let modelType in this.models) {\r\n      if (this.models[modelType].length > 0) {\r\n        let model = this.models[modelType][0];\r\n        let modelNumStr = '';\r\n        if (this.models[modelType].length > 1) {\r\n          modelNumStr = ' (' + this.models[modelType].length +')';\r\n        }\r\n        HTML += '<tr>'\r\n          + '<td class=\"stat\" id=\"name\">' + model.name + modelNumStr + '</td>'\r\n          + '<td class=\"stat\" id=\"m\">' + this.getUnProfiledStats(model.modelInfo.M) + '</td>'\r\n          + '<td class=\"stat\" id=\"ws\">' + this.getUnProfiledStats(model.modelInfo.WS) + '</td>'\r\n          + '<td class=\"stat\" id=\"bs\">' + this.getUnProfiledStats(model.modelInfo.BS) + '</td>'\r\n          + '<td class=\"stat\" id=\"s\">' + this.getUnProfiledStats(model.modelInfo.S) + '</td>'\r\n          + '<td class=\"stat\" id=\"t\">' + this.getUnProfiledStats(model.modelInfo.T) + '</td>'\r\n          + '<td class=\"stat\" id=\"w\">' + this.getUnProfiledStats(model.modelInfo.W) + '</td>'\r\n          + '<td class=\"stat\" id=\"a\">' + this.getUnProfiledStats(model.modelInfo.A) +'</td>'\r\n          + '<td class=\"stat\" id=\"ld\">' + this.getUnProfiledStats(model.modelInfo.Ld) + '</td>'\r\n          + '<td class=\"stat\" id=\"sv\">' + this.getUnProfiledStats(model.modelInfo.Sv) + '</td>'\r\n          + '</tr>';\r\n      }\r\n    }\r\n    return HTML;\r\n  }\r\n\r\n  public getUnProfiledStats(stat: any) {\r\n    if (typeof stat === \"string\" || typeof stat === \"number\") {\r\n      return stat;\r\n    }\r\n    else {\r\n      let stats = '';\r\n      for (let i = 0; i < stat.length; i++) {\r\n        stats += '<b>' + stat[i].value + '</b> (' + stat[i].Wounds[0] + '-' + stat[i].Wounds[1] + ')<br/>';\r\n      }\r\n      return stats;\r\n    }\r\n  }\r\n\r\n  public getWeaponsHeadersHTML(): string {\r\n    let HTML = '<tr>'\r\n        + '<th class=\"leftHeader\">Wargear</th>'\r\n        + '<th>Range</th>'\r\n        + '<th>Type</th>'\r\n        + '<th>S</th>'\r\n        + '<th>AP</th>'\r\n        + '<th>D</th>'\r\n        + '<th colspan=\"4\">Abilities</th>'\r\n        + '</tr>';\r\n    return HTML;\r\n  }\r\n\r\n  public getWeaponsHTML(): string {\r\n    let listOfWeapons: Array<string> = [];\r\n    let amountsPerWeapon: Array<number> = [];\r\n    let HTML = '';\r\n    for (let modelType in this.models) {\r\n      for (let i = 0; i < this.models[modelType].length; i++) {\r\n        let weapons: Array<string> = [];\r\n        let wargear = this.models[modelType][i].modelInfo.Wargear;\r\n        for (let slot in wargear) {\r\n          let selectedIndex = this.models[modelType][i].selectedWeaponConfig[slot] || 0;\r\n          for (let weaponId of wargear[slot][selectedIndex]) {\r\n            weapons.push(weaponId);\r\n          }\r\n        }\r\n        for (let weapon in weapons) {\r\n          if (listOfWeapons.indexOf(weapons[weapon]) === -1) {\r\n            listOfWeapons.push(weapons[weapon]);\r\n            amountsPerWeapon.push(1);\r\n          }\r\n          else {\r\n            amountsPerWeapon[listOfWeapons.indexOf(weapons[weapon])]++;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    for (let weaponIndex in listOfWeapons) {\r\n      let weapon = listOfWeapons[weaponIndex];\r\n      let weaponInfo = window.list.data.data[this.faction].wargear[weapon];\r\n      let numberOf = '';\r\n      if (amountsPerWeapon[weaponIndex] > 1) {\r\n        numberOf = ' (' + amountsPerWeapon[weaponIndex] +')';\r\n      }\r\n      if (weaponInfo !== undefined) {\r\n        if (weaponInfo.WargearAbility !== undefined) {\r\n          HTML += '<tr>'\r\n          + '<td class=\"stat\" id=\"name\">' + weapon + '</td>'\r\n          + '<td class=\"stat\" id=\"abilities\" colspan=\"9\">' + weaponInfo.WargearAbility + '</td>'\r\n          + '</tr>';\r\n        }\r\n        else if (weaponInfo.profiles === undefined) {\r\n          HTML += '<tr>'\r\n          + '<td class=\"stat\" id=\"name\">' + weapon + numberOf +'</td>'\r\n          + '<td class=\"stat\" id=\"range\">' + weaponInfo.Range + '</td>'\r\n          + '<td class=\"stat\" id=\"type\">' + weaponInfo.Type + '</td>'\r\n          + '<td class=\"stat\" id=\"s\">' + weaponInfo.S + '</td>'\r\n          + '<td class=\"stat\" id=\"ap\">' + weaponInfo.AP + '</td>'\r\n          + '<td class=\"stat\" id=\"d\">' + weaponInfo.D + '</td>'\r\n          + '<td class=\"stat\" id=\"abilities\" colspan=\"4\">' + weaponInfo.Abilities + '</td>'\r\n          + '</tr>';\r\n        }\r\n        else {\r\n          let desription = weaponInfo.description === undefined ? '' : weaponInfo.description;\r\n          HTML += '<tr class=\"profiledWeapon\">'\r\n          + '<td class=\"stat\" id=\"name\">' + weapon + '</td>'\r\n          + '<td class=\"stat\" id=\"description\" colspan=\"9\">' + desription + '</td>'\r\n          + '</tr>';\r\n          for (let profile in weaponInfo.profiles) {\r\n            let profileInfo = weaponInfo.profiles[profile];\r\n            if (profileInfo !== undefined) {\r\n              HTML += '<tr class=\"profile\">'\r\n              + '<td class=\"stat\" id=\"name\"> - ' + profile + '</td>'\r\n              + '<td class=\"stat\" id=\"range\">' + profileInfo.Range + '</td>'\r\n              + '<td class=\"stat\" id=\"type\">' + profileInfo.Type + '</td>'\r\n              + '<td class=\"stat\" id=\"s\">' + profileInfo.S + '</td>'\r\n              + '<td class=\"stat\" id=\"ap\">' + profileInfo.AP + '</td>'\r\n              + '<td class=\"stat\" id=\"d\">' + profileInfo.D + '</td>'\r\n              + '<td class=\"stat\" id=\"abilities\" colspan=\"4\">' + profileInfo.Abilities + '</td>'\r\n              + '</tr>';\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return HTML;\r\n  }\r\n\r\n  public getAbilitiesHTML(): string {\r\n    let abilityHTML = '<tr class=\"abilities\"><th>Abilities</th><td colspan=\"9\">';\r\n    let abilityList: Array<any> = [];\r\n    for (let modelType in this.models) {\r\n      for (let i = 0; i < this.models[modelType].length; i++) {\r\n        let abilities = this.models[modelType][i].modelInfo.Abilities;\r\n        for (let ability in abilities) {\r\n          if (typeof abilities[ability] !== \"string\") {\r\n            for (let factionAbility in abilities[ability]) {\r\n              let htmlString = this.getFactionAbility(factionAbility);\r\n              if (abilityList.indexOf(htmlString) === -1) {\r\n                abilityList.push(htmlString);\r\n              }\r\n            }\r\n          }\r\n          else {\r\n            let htmlString = '<b>' + ability + ':</b> ' + this.models[modelType][i].modelInfo.Abilities[ability] + '<br/>';\r\n            if (abilityList.indexOf(htmlString) === -1) {\r\n              abilityList.push(htmlString);\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    for (let i = 0; i < abilityList.length; i++) {\r\n      abilityHTML += abilityList[i];\r\n      if (i < abilityList.length - 1) {\r\n        abilityHTML += '<br/>';\r\n      }\r\n    }\r\n    abilityHTML += '</td></tr>';\r\n    return abilityHTML;\r\n  }\r\n\r\n  public getFactionAbility(id: number | string) {\r\n    return '<b>' + window.list.data.data[this.faction].factionSpecialRules[id].name + '</b>: '\r\n    + window.list.data.data[this.faction].factionSpecialRules[id].description + '<br/>';\r\n  }\r\n\r\n  public getPsykerHTML(): string {\r\n    let psykerHTML = '';\r\n    for (let modelType in this.models) {\r\n      if (this.models[modelType].length > 0 && this.models[modelType][0].modelInfo.Psyker !== undefined) {\r\n        psykerHTML += '<tr class=\"psykerAbilities\"><th>Psyker</th>'\r\n          + '<td colspan=\"9\">' + this.models[modelType][0].modelInfo.Psyker\r\n          + '</td></tr>';\r\n      }\r\n    }\r\n    return psykerHTML;\r\n  }\r\n\r\n  public getAllegianceHTML(): string {\r\n    let allegianceHTML = '';\r\n    for (let modelType in this.models) {\r\n      if (this.models[modelType].length > 0) {\r\n        if (this.models[modelType][0].modelInfo.Allegiance !== undefined) {\r\n          allegianceHTML += '<tr class=\"allegiance\"><th>Allegiance</th><td colspan=\"9\">' + this.models[modelType][0].modelInfo.Allegiance[this.models[modelType][0].selectedAllegiance] + '</td></tr>';\r\n          return allegianceHTML;\r\n        }\r\n      }\r\n    }\r\n    return '';\r\n  }\r\n\r\n  public getKeywordsHTML(): string {\r\n    let keywords: Array<any> = [];\r\n    for (let modelType in this.models) {\r\n      if (this.models[modelType].length > 0) {\r\n        for (let i = 0; i < this.models[modelType][0].modelInfo[\"Faction Keywords\"].length; i++) {\r\n          let keyword = this.models[modelType][0].modelInfo[\"Faction Keywords\"][i].toUpperCase();\r\n          if (keywords.indexOf(keyword) === -1) {\r\n            keywords.push(keyword);\r\n          }\r\n        }\r\n        for (let i = 0; i < this.models[modelType][0].modelInfo.Keywords.length; i++) {\r\n          let keyword = this.models[modelType][0].modelInfo.Keywords[i].toUpperCase();\r\n          if (keywords.indexOf(keyword) === -1) {\r\n            keywords.push(keyword);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    let keywordHTML = '<tr class=\"keywords\"><th>Keywords</th><td colspan=\"9\">';\r\n    for (let keyword of keywords) {\r\n      if (keywords.indexOf(keyword) < keywords.length - 1) {\r\n        keywordHTML += keyword + ', ';\r\n      }\r\n      else {\r\n        keywordHTML += keyword;\r\n      }\r\n    }\r\n    keywordHTML += '</td></tr>';\r\n    return keywordHTML;\r\n  }\r\n\r\n  public updateCosts() {\r\n    this.calculateModels();\r\n    this.calculateWounds();\r\n    this.calculatePoints();\r\n    this.calculatePower();\r\n  }\r\n\r\n  public addModel(modelType) {\r\n    let model = this.unitInfo.modelTypes[modelType].model;\r\n    let modelInfo = window.list.data.data[this.faction].models[model];\r\n    if (modelInfo !== undefined) {\r\n      let newModel = new Model(model, modelInfo);\r\n      this.models[model].push(newModel);\r\n    }\r\n    this.updateCosts();\r\n    window.list.armyList.updateCosts();\r\n    window.list.editor.renderEdit();\r\n  }\r\n\r\n  public removeModel(modelType) {\r\n    let model = this.unitInfo.modelTypes[modelType].model;\r\n    if (this.models[model].length > 1) {\r\n      this.models[model].pop();\r\n    }\r\n    else {\r\n      this.models[model] = [];\r\n    }\r\n    this.updateCosts();\r\n    window.list.armyList.updateCosts();\r\n    window.list.editor.renderEdit();\r\n  }\r\n\r\n  public updateModelWargear(modelType, modelIndex, weaponSlot, selectedWeaponConfig) {\r\n    let model = this.unitInfo.modelTypes[modelType].model;\r\n    this.models[model][modelIndex].selectedWeaponConfig[weaponSlot] = selectedWeaponConfig;\r\n    this.updateCosts();\r\n    window.list.armyList.updateCosts();\r\n    window.list.editor.renderEdit();\r\n  }\r\n\r\n  public updateAllegiance(index: number) {\r\n    for (let modelType in this.models) {\r\n      for (let modelIndex in this.models[modelType]) {\r\n        let model = this.models[modelType][modelIndex];\r\n        model.selectedAllegiance = index;\r\n      }\r\n    }\r\n  }\r\n\r\n  private calculateModels() {\r\n    let models = 0;\r\n    for (let modelType in this.models) {\r\n      models += this.models[modelType].length;\r\n    }\r\n    this.totalModels = models;\r\n  }\r\n\r\n  private calculateWounds() {\r\n    let wounds = 0;\r\n    for (let modelType in this.models) {\r\n      for (let modelIndex in this.models[modelType]) {\r\n        wounds += this.models[modelType][modelIndex].modelInfo.W;\r\n      }\r\n    }\r\n    this.totalWounds = wounds;\r\n  }\r\n\r\n  private calculatePoints() {\r\n    let points = 0;\r\n    for (let modelType in this.models) {\r\n      for (let modelIndex in this.models[modelType]) {\r\n        let model = this.models[modelType][modelIndex];\r\n        points += model.modelInfo.Points;\r\n        if (!model.modelInfo.PointsIncludesWargear) {\r\n          for (let slot in model.modelInfo.Wargear) {\r\n            let index = model.selectedWeaponConfig[slot] || 0;\r\n            let selectedWeapons = model.modelInfo.Wargear[slot][index];\r\n            for (let weapon = 0; weapon < selectedWeapons.length; weapon++) {\r\n              points += window.list.data.data[this.faction].wargear[selectedWeapons[weapon]].Points;\r\n            } \r\n          }\r\n        }\r\n      }\r\n    }\r\n    this.totalPoints = points;\r\n  }\r\n\r\n  private calculatePower() {\r\n    let power = 0;\r\n    for (let i = this.unitInfo.power.length - 1; i >= 0; i--) {\r\n      if (this.totalModels >= this.unitInfo.power[i][0]) {\r\n        power = this.unitInfo.power[i][1];\r\n        break;\r\n      }\r\n    }\r\n    this.totalPower = power;\r\n  }\r\n\r\n  private setupDefaultModels() {\r\n    for (let modelType in this.unitInfo.modelTypes) {\r\n      let model = this.unitInfo.modelTypes[modelType].model;\r\n      this.models[model] = [];\r\n      let modelInfo = window.list.data.data[this.faction].models[model];\r\n      if (modelInfo !== undefined) {\r\n        for (let num = 0; num < this.unitInfo.modelTypes[modelType].defaultAmount; num++) {\r\n          let newModel = new Model(model, modelInfo);\r\n          this.models[model].push(newModel);\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n","let Settings = {\r\n  supportedFactions: [\r\n    'Craftworlds',\r\n    'Harlequins',\r\n    'Ynnari'\r\n  ]\r\n};\r\n\r\nexport default Settings;\r\n","export default class Costs {\r\n\r\n  // cost values\r\n  public costs: Array<number>;\r\n\r\n  // elements\r\n  private pointsElement: HTMLElement;\r\n  private powerElement: HTMLElement;\r\n  private woundsElement: HTMLElement;\r\n  private modelsElement: HTMLElement;\r\n\r\n  constructor() {\r\n    this.costs = [0,0,0,0];\r\n    this.pointsElement = document.getElementById(\"POINTS\") as HTMLElement;\r\n    this.powerElement = document.getElementById(\"POWER\") as HTMLElement;\r\n    this.woundsElement = document.getElementById(\"WOUNDS\") as HTMLElement;\r\n    this.modelsElement = document.getElementById(\"MODELS\") as HTMLElement;\r\n  }\r\n\r\n  public init() {\r\n    this.updateCosts();\r\n  }\r\n\r\n  public updateCostsExt(costs: Array<number>) {\r\n    this.costs[0] = costs[0];\r\n    this.costs[1] = costs[1];\r\n    this.costs[2] = costs[2];\r\n    this.costs[3] = costs[3];\r\n    this.updateCosts();\r\n  }\r\n\r\n  private updateCosts() {\r\n    this.pointsElement.innerHTML = '<div class=\"costValue\">' + this.costs[0] + '</div>' + 'POINTS';\r\n    this.powerElement.innerHTML = '<div class=\"displayedCostSmall\">Power: ' + this.costs[1] + '</div>';\r\n    this.woundsElement.innerHTML = '<div class=\"displayedCostSmall\">Wounds: ' + this.costs[2] + '</div>';\r\n    this.modelsElement.innerHTML = '<div class=\"displayedCostSmall\">Models: ' + this.costs[3] + '</div>';\r\n  }\r\n}\r\n"]}